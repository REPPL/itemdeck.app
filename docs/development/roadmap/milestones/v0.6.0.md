# v0.6.0 - Schema Loader

## Theme

Runtime loader for v1 schema format with relationship resolution.

## Features

| ID | Feature | Complexity | Status |
|----|---------|------------|--------|
| - | Type Definitions | Medium | ✅ Complete |
| - | Collection Loader | Medium | ✅ Complete |
| - | Relationship Resolver | Large | ✅ Complete |
| - | Image Selector | Medium | ✅ Complete |
| - | Field Path Parser | Medium | ✅ Complete |
| - | Data Migration | Medium | ✅ Complete |
| - | Hook Integration | Medium | ✅ Complete |

## Overview

This milestone focuses on:

1. **Type Definitions** - TypeScript types mirroring JSON Schema specs
2. **Collection Loader** - Load and parse v1 collection definitions
3. **Relationship Resolver** - Resolve foreign key references between entities
4. **Image Selector** - Expression-based image selection with filters
5. **Field Path Parser** - Dot-notation access to entity fields
6. **Migration Script** - Convert legacy data to v1 format
7. **Hook Integration** - Auto-detect format in useCollection hook

## Accomplishments

- Created TypeScript types for schema, image, and display
- Built collection loader with format auto-detection
- Implemented relationship resolver with O(1) lookups
- Created image expression language parser
- Built field path parser for dot-notation access
- Migrated retro-games collection (79 games, 13 platforms)
- Updated useCollection hook with backward compatibility
- Added 46 tests for loaders (257 total tests)

## Dependencies

- **Requires**: v0.5.0 Schema Design
- **Blocks**: v0.7.0 Visual Overhaul

## Key Decisions

- Support both legacy and v1 formats simultaneously
- Auto-detect format based on file content
- Keep legacy files during migration for rollback
- Lowercase entity IDs for consistent referencing

## Draft Release Notes

### Added
- v1 schema format loader
- Relationship resolution between entities
- Image expression parser (`images[type=cover][0] ?? images[0]`)
- Field path accessor (`platform.title`)
- Data migration script
- 46 new loader tests

### Changed
- useCollection hook auto-detects format
- retro-games collection migrated to v1 format

### Technical
- O(1) entity lookups via resolver context maps
- Parallel entity loading for performance
- Backward compatible DisplayCard interface

---

## Related Documentation

- [Roadmap Overview](../README.md)
- [Features Index](../features/README.md)
- [v0.6.0 Implementation Prompt](../../../prompts/implementation/v0.6.0/README.md)
- [v0.6.0 Devlog](../../process/devlogs/v0.6.0/README.md)
- [v0.6.0 Retrospective](../../process/retrospectives/v0.6.0/README.md)
- [v1 Schema Reference](../../../reference/schemas/v1/README.md)
- [v0.5.0 Schema Design](./v0.5.0.md)

---

**Status**: Complete
