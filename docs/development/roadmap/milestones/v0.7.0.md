# v0.7.0 - Schema Flexibility

## Theme

Generalise schema to support any collection domain with rich metadata structures.

## Features

| ID | Feature | Complexity | Status |
|----|---------|------------|--------|
| - | Schema Type Definitions | Medium | ✅ Complete |
| - | Zod Validation | Medium | ✅ Complete |
| - | Loader Updates | Medium | ✅ Complete |
| - | Dynamic Field Discovery | Large | ✅ Complete |
| - | Terminology Generalisation | Medium | ✅ Complete |
| - | UI Attribution Display | Medium | ✅ Complete |
| - | Demo Data Migration | Medium | ✅ Complete |
| - | Schema v2 Reference | Small | ✅ Complete |

## Overview

This milestone focuses on:

1. **Schema Type Definitions** - New types for Rating, DetailLink with normalisation
2. **Zod Validation** - Runtime validation with helpful error messages
3. **Loader Updates** - Support isPrimary, structured ratings, detailUrls
4. **Dynamic Field Discovery** - Replace hardcoded dropdown options with schema introspection
5. **Terminology Generalisation** - Generic terms (platform → category, rank → order)
6. **UI Attribution Display** - Show source links, licences in expanded cards
7. **Demo Data Migration** - Gemini's 81 games + recipes collection
8. **Schema v2 Reference** - Documentation for new schema features

## Key Changes

### Schema v1 → v2

| Feature | v1 (Current) | v2 (New) |
|---------|--------------|----------|
| Images | `imageUrls: string[]` | Structured with `isPrimary`, `type`, `attribution` |
| Attribution | `imageAttribution?: string` | Per-image object with `source`, `sourceUrl`, `licence` |
| Ratings | `rating?: number` | `rating: number \| RatingValue` with source metadata |
| Detail URLs | `detailUrl?: string` | `detailUrls: DetailLink[]` array with sources |
| Field Discovery | Hardcoded dropdown options | Dynamic from schema |
| Validation | Manual type assertions | Zod schemas with helpful errors |
| Schema Version | Implicit | Explicit `schemaVersion: "v2"` |

## Dependencies

- **Requires**: v0.6.0 Schema Loader
- **Blocks**: v0.8.0 Visual Overhaul

## Key Decisions

- Use Gemini-enriched data (81 games) as the primary demo collection
- Add a second non-game collection (recipes) to prove generalisation
- Generalise game-specific terminology (platform → category, rank → order)
- No backward compatibility needed (private repo)
- Implement Zod validation for runtime schema checking

## Draft Release Notes

### Added
- v2 schema format with structured ratings and attribution
- Zod runtime validation with helpful error messages
- Dynamic field discovery from schema
- Attribution component with source/licence links
- Multiple detail URLs per card
- Recipes demo collection (proves domain generalisation)
- Schema v2 reference documentation

### Changed
- DisplayCard uses generic terminology (category, order)
- Settings dropdowns populate from schema
- Games collection upgraded to 81 Gemini-enriched entries
- Images support `isPrimary` flag

### Technical
- `RatingValue` interface with score, max, sourceCount, source
- `DetailLink` interface with url, source, label, isPrimary
- `FieldOptionsContext` for dynamic field options
- `fieldDiscovery` service for schema introspection

---

## Related Documentation

- [Roadmap Overview](../README.md)
- [Features Index](../features/README.md)
- [v0.7.0 Implementation Prompt](../../../prompts/implementation/v0.7.0/README.md)
- [v0.6.0 Schema Loader](./v0.6.0.md)

---

**Status**: Complete
